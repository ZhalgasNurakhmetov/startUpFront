<ion-header [mode]="platform">
  <ion-toolbar [mode]="platform">
    <ion-buttons slot="start">
      <ion-back-button [mode]="platform" [text]="'Назад'" [defaultHref]="'login'"></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content [scrollY]="false" class="layout">
  <ion-progress-bar [mode]="platform" type="indeterminate" *ngIf="isLoading" color="tertiary"></ion-progress-bar>
  <div class="registration">
    <ion-text class="registration registration__logo logo-text" [mode]="platform">Bookberry</ion-text>
    <div class="registration registration__form">
      <form [formGroup]="form" (ngSubmit)="registerUser()">
        <ion-item [mode]="platform" lines="inset" class="credential">
          <ion-label color="tertiary" [mode]="platform" position="floating">
            <ion-text [mode]="platform">
              Имя
            </ion-text>
          </ion-label>
          <ion-input [mode]="platform" inputmode="text" autocapitalize="words" clear-input autofocus type="text" [formControl]="form?.controls?.firstName">
          </ion-input>
        </ion-item>
        <div
          *ngIf="form.controls.firstName.errors && (form.controls.firstName.dirty || form.controls.firstName.touched)"
        >
          <ion-text
            *ngIf="form.controls.firstName.errors.required" [mode]="platform" color="danger">
            Обязательное поле
          </ion-text>
          <ion-text [mode]="platform" *ngIf="form.controls.firstName.errors.pattern" color="danger">
            Не может состоять только из пробелов
          </ion-text>
        </div>
        <ion-item [mode]="platform" lines="inset">
          <ion-label color="tertiary" [mode]="platform" position="floating">
            <ion-text [mode]="platform">
              Фамилия
            </ion-text>
          </ion-label>
          <ion-input [mode]="platform" inputmode="text" autocapitalize="words" clear-input type="text" [formControl]="form.controls.lastName">
          </ion-input>
        </ion-item>
        <div
          *ngIf="form.controls.lastName.errors && (form.controls.lastName.dirty || form.controls.lastName.touched)"
        >
          <ion-text
            *ngIf="form.controls.lastName.errors.required" [mode]="platform" color="danger">
            Обязательное поле
          </ion-text>
          <ion-text [mode]="platform" *ngIf="form.controls.lastName.errors.pattern" color="danger">
            Не может состоять только из пробелов
          </ion-text>
        </div>
        <ion-item [mode]="platform" lines="inset">
          <ion-label color="tertiary" [mode]="platform" position="floating">
            <ion-text [mode]="platform">
              Дата рождения
            </ion-text>
          </ion-label>
          <ion-datetime [mode]="platform" cancel-text="Отмена" done-text="Готово" [monthShortNames]="monthList" [formControl]="form.controls.birthDate">
          </ion-datetime>
        </ion-item>
        <div
          *ngIf="form.controls.birthDate.errors && (form.controls.birthDate.dirty || form.controls.birthDate.touched)"
        >
          <ion-text *ngIf="form.controls.birthDate.errors.required" [mode]="platform" color="danger">
            Обязательное поле
          </ion-text>
        </div>
        <ion-item [mode]="platform" lines="inset">
          <ion-label color="tertiary" [mode]="platform" position="floating">
            <ion-text [mode]="platform">
              Электронная почта
            </ion-text>
          </ion-label>
          <ion-input [mode]="platform" inputmode="email" clear-input type="email" [formControl]="form.controls.username">
          </ion-input>
        </ion-item>
        <div
          *ngIf="form.controls.username.errors && (form.controls.username.dirty || form.controls.username.touched)"
        >
          <ion-text [mode]="platform" *ngIf="form.controls.username.errors.required" color="danger">
            Обязательное поле
          </ion-text>
          <ion-text [mode]="platform" *ngIf="form.controls.username.errors.pattern" color="danger">
            Неверный формат почты
          </ion-text>
        </div>
        <ion-item [mode]="platform" lines="inset">
          <ion-label color="tertiary" [mode]="platform" position="floating">
            <ion-text [mode]="platform">
              Город
            </ion-text>
          </ion-label>
          <ion-select [mode]="platform" value="{{form?.controls?.city?.value}}" okText="Выбрать" cancelText="Закрыть" [formControl]="form?.controls?.city">
            <ion-select-option
              *ngFor="let city of cityList; let i = index; trackBy: trackById"
              value="{{city}}"
            >
              {{city}}
            </ion-select-option>
          </ion-select>
        </ion-item>
        <div
          *ngIf="form.controls.city.errors && (form.controls.city.dirty || form.controls.city.touched)"
        >
          <ion-text
            *ngIf="form.controls.city.errors.required" color="danger" [mode]="platform">
            Обязательное поле
          </ion-text>
        </div>
        <ion-item [mode]="platform" lines="inset">
          <ion-label color="tertiary" [mode]="platform" position="floating">
            <ion-text [mode]="platform">
              Пароль
            </ion-text>
          </ion-label>
          <ion-input [mode]="platform" clear-input type="password" [formControl]="form.controls.password">
          </ion-input>
        </ion-item>
        <div
          *ngIf="form.controls.password.errors && (form.controls.password.dirty || form.controls.password.touched)"
        >
          <ion-text [mode]="platform" *ngIf="form.controls.password.errors.required" color="danger">
            Обязательное поле
          </ion-text>
          <br>
          <ion-text [mode]="platform" *ngIf="form.controls.password.errors.minlength" color="danger">
            Минимальная длина 8 символов
          </ion-text>
          <br>
          <ion-text [mode]="platform" *ngIf="form.controls.password.errors.pattern" color="danger">
            Не может состоять только из пробелов
          </ion-text>
        </div>
        <ion-button [mode]="platform" type="submit" color="tertiary" class="registration-button ion-margin-top">
          <ion-text [mode]="platform">
            Регистрация
          </ion-text>
        </ion-button>
      </form>
    </div>
  </div>
</ion-content>
