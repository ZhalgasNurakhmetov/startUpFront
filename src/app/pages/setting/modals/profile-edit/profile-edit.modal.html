<ion-header [mode]="platform">
  <ion-toolbar [mode]="platform">
    <ion-title><ion-text [mode]="platform">Редактирование</ion-text></ion-title>
    <ion-buttons slot="end">
      <ion-button [mode]="platform" [disabled]="isLoading" (click)="dismiss()">Закрыть</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content [scrollY]="false" class="layout">
  <ion-progress-bar [mode]="platform" type="indeterminate" *ngIf="isLoading" color="tertiary"></ion-progress-bar>
  <div class="profile-edit">
    <div class="profile-edit profile-edit__form">
      <form [formGroup]="form" (ngSubmit)="editProfile()">
        <ion-item [mode]="platform" lines="inset" class="credential">
          <ion-label color="tertiary" [mode]="platform" position="floating">
            <ion-text [mode]="platform">
              Имя
            </ion-text>
          </ion-label>
          <ion-input [mode]="platform" inputmode="text" autocapitalize="words" clear-input autofocus type="text" [formControl]="form?.controls?.firstName">
          </ion-input>
        </ion-item>
        <div
          *ngIf="form.controls.firstName.errors && (form.controls.firstName.dirty || form.controls.firstName.touched)"
        >
          <ion-text
            *ngIf="form.controls.firstName.errors.required" [mode]="platform" color="danger">
            Обязательное поле
          </ion-text>
          <ion-text [mode]="platform" *ngIf="form.controls.firstName.errors.pattern" color="danger">
            Не может состоять только из пробелов
          </ion-text>
        </div>
        <ion-item [mode]="platform" lines="inset">
          <ion-label color="tertiary" [mode]="platform" position="floating">
            <ion-text [mode]="platform">
              Фамилия
            </ion-text>
          </ion-label>
          <ion-input [mode]="platform" inputmode="text" autocapitalize="words" clear-input type="text" [formControl]="form.controls.lastName">
          </ion-input>
        </ion-item>
        <div
          *ngIf="form.controls.lastName.errors && (form.controls.lastName.dirty || form.controls.lastName.touched)"
        >
          <ion-text
            *ngIf="form.controls.lastName.errors.required" [mode]="platform" color="danger">
            Обязательное поле
          </ion-text>
          <ion-text [mode]="platform" *ngIf="form.controls.lastName.errors.pattern" color="danger">
            Не может состоять только из пробелов
          </ion-text>
        </div>
        <ion-item [mode]="platform" lines="inset">
          <ion-label color="tertiary" [mode]="platform" position="floating">
            <ion-text [mode]="platform">
              Дата рождения
            </ion-text>
          </ion-label>
          <ion-datetime [mode]="platform" cancel-text="Отмена" done-text="Готово" [monthShortNames]="monthList" [formControl]="form.controls.birthDate">
          </ion-datetime>
        </ion-item>
        <div
          *ngIf="form.controls.birthDate.errors && (form.controls.birthDate.dirty || form.controls.birthDate.touched)"
        >
          <ion-text *ngIf="form.controls.birthDate.errors.required" [mode]="platform" color="danger">
            Обязательное поле
          </ion-text>
        </div>
        <ion-item [mode]="platform" lines="inset">
          <ion-label color="tertiary" [mode]="platform" position="floating">
            <ion-text [mode]="platform">
              Город
            </ion-text>
          </ion-label>
          <ion-select [mode]="platform" value="{{form?.controls?.city?.value}}" okText="Выбрать" cancelText="Закрыть" [formControl]="form?.controls?.city">
            <ion-select-option
              *ngFor="let city of cityList; let i = index; trackBy: trackById"
              value="{{city}}"
            >
              <ion-text [mode]="platform">{{city}}</ion-text>
            </ion-select-option>
          </ion-select>
        </ion-item>
        <div
          *ngIf="form.controls.city.errors && (form.controls.city.dirty || form.controls.city.touched)"
        >
          <ion-text
            *ngIf="form.controls.city.errors.required" color="danger" [mode]="platform">
            Обязательное поле
          </ion-text>
        </div>
        <ion-item [mode]="platform" lines="inset">
          <ion-label color="tertiary" [mode]="platform" position="floating">
            <ion-text [mode]="platform">
              О себе
            </ion-text>
          </ion-label>
          <ion-textarea [mode]="platform" inputmode="text" autocapitalize="sentences" maxlength="120" type="text" [formControl]="form.controls.about">
          </ion-textarea>
        </ion-item>
        <div
          *ngIf="form.controls.about.errors && (form.controls.about.dirty || form.controls.about.touched)"
        >
          <ion-text *ngIf="form.controls.about.errors.maxlength" [mode]="platform" color="danger">
            Максимальная длина 120 символов
          </ion-text>
          <ion-text [mode]="platform" *ngIf="form.controls.about.errors.pattern" color="danger">
            Не может состоять только из пробелов
          </ion-text>
        </div>
        <ion-button [mode]="platform" type="submit" color="tertiary" [disabled]="isLoading" class="profile-edit-button ion-margin-top">
          <ion-text [mode]="platform">
            Сохранить
          </ion-text>
        </ion-button>
      </form>
    </div>
  </div>
</ion-content>
